# Parametrix

Welcome to this repository created for the Parametrix tool. Parametrix teaches parametric designing by combining an approachable, simple to use pixel art design and the Fusion 360 API. Below are the Javascript and Python docs for the Parametrix tool

# UI

## 1. Electron Main Process

The **Electron Main Process** manages the lifecycle of the application, creating the main window and handling communication between the renderer process (frontend) and backend server. It uses IPC (Inter-Process Communication) to facilitate data exchange between these layers.

### Key Responsibilities:
- Initialize and configure the application window.
- Serve as a bridge between the renderer and backend for data flow.
- Manage navigation between pages dynamically rendered as HTML strings.

### Detailed Code with Explanations

#### 1.1 Importing Modules
```javascript
const { app, BrowserWindow, ipcMain } = require("electron");
const axios = require("axios");
const fs = require("fs");
const path = require("path");
```

app: Handles the Electron application's lifecycle (start, quit, etc.).
BrowserWindow: Creates and configures the application window.
ipcMain: Listens for events from the renderer process.
axios: Makes HTTP requests to the backend.
fs and path: Read and manipulate local JSON files defining shapes.

#### 1.2 Initializing the Application Window

```javascript
let mainWindow;

app.on("ready", () => {
  mainWindow = new BrowserWindow({
    width: 800, // Window width
    height: 600, // Window height
    webPreferences: {
      contextIsolation: false, // Enables renderer to access Node.js modules
      nodeIntegration: true,  // Allows Node.js integration in the renderer
    },
  });

  // Load the main menu on startup
  mainWindow.loadURL(`data:text/html;charset=utf-8,${encodeURIComponent(renderHTML())}`);
});
```


The BrowserWindow is configured to integrate Node.js within the frontend for seamless interaction.
Initial Page Load: The main menu page is rendered using the renderHTML function, dynamically creating the HTML content.

#### 1.3 Backend Communcation

```javascript
ipcMain.on("send-command", async (event, command) => {
  try {
    const response = await axios.post("http://127.0.0.1:5001/process", { command }); // Backend request
    event.sender.send("command-response", response.data); // Sends the backend response to the renderer
  } catch (error) {
    console.error("Error communicating with the backend:", error.message);
    event.sender.send("command-response", { error: "Failed to connect to the server." });
  }
});
```

The renderer sends a command via IPC.
The main process forwards it to the backend using Axios.
The backend processes the command and sends back a response.
The main process relays the response to the renderer

#### 1.4 Navigation Between Pages

```javascript
ipcMain.on("load-level-selection", () => {
  mainWindow.loadURL(`data:text/html;charset=utf-8,${encodeURIComponent(renderLevelSelectionPage())}`);
});

ipcMain.on("start-level", (event, level) => {
  mainWindow.loadURL(`data:text/html;charset=utf-8,${encodeURIComponent(renderLevelPage(level))}`);
});

ipcMain.on("go-back-to-main", () => {
  mainWindow.loadURL(`data:text/html;charset=utf-8,${encodeURIComponent(renderHTML())}`);
});

```
Dynamically loads HTML content for each page based on user actions.
Each page is generated by dedicated functions (e.g.: renderHTML, renderLevelSelectionPage,)

## 2. HTML Renderer

The renderer process generates UI elements dynamically using JavaScript functions. Each function returns an HTML string, which is loaded into the BrowserWindow via the main process.

### Key Pages
Main Menu: Entry point for the application.
Level Selection: Displays available levels for navigation.
Levels: Each level provides a unique parametric design challenge.

#### 2.1 Main Menu Page

```javascript

function renderHTML() {
  return `
    <!DOCTYPE html>
    <html lang="en">
      <head>
        <meta charset="UTF-8" />
        <title>Parametrix</title>
        <style>
          body {
            margin: 0;
            padding: 0;
            background-color: black;
            color: white;
            font-family: 'Press Start 2P', cursive;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
          }
          .start-button {
            padding: 10px 20px;
            border: 2px solid white;
            background: none;
            color: white;
            font-size: 1rem;
            cursor: pointer;
            transition: transform 0.2s;
          }
          .start-button:hover {
            transform: scale(1.1);
          }
        </style>
      </head>
      <body>
        <h1>PARAMETRIX</h1>
        <button class="start-button" onclick="loadLevelSelection()">Start</button>
        <script>
          const { ipcRenderer } = require("electron");
          function loadLevelSelection() {
            ipcRenderer.send("load-level-selection");
          }
        </script>
      </body>
    </html>
  `;
}
```

Styling: Retro-inspired
Interactive Button: Navigates to the level selection page using IPC.

#### 2.2 Level Selection Page

```javascript
function renderLevelSelectionPage() {
  return `
    <!DOCTYPE html>
    <html lang="en">
      <head>
        <meta charset="UTF-8" />
        <title>Level Selection</title>
        <style>
          .grid-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            padding: 20px;
          }
          .grid-item {
            text-align: center;
            padding: 20px;
            border: 2px solid white;
            background-color: black;
            color: white;
            font-family: 'Press Start 2P', cursive;
            cursor: pointer;
            transition: transform 0.2s;
          }
          .grid-item:hover {
            transform: scale(1.1);
          }
        </style>
      </head>
      <body>
        <h1>Select a Level</h1>
        <div class="grid-container">
          ${Array.from({ length: 6 }, (_, i) => `
            <div class="grid-item" onclick="selectLevel(${i + 1})">Level ${i + 1}</div>
          `).join('')}
        </div>
        <script>
          const { ipcRenderer } = require("electron");
          function selectLevel(level) {
            ipcRenderer.send("start-level", level);
          }
        </script>
      </body>
    </html>
  `;
}
```

## 3. Backend Communication

The renderer sends a user command to the main process.
The main process forwards the command to the backend using Axios.
The backend processes the command and returns JSON data.
The renderer visualizes the shapes based on the response.

```javascript
const response = await axios.post("http://127.0.0.1:5001/process", { command });
```
Endpoint: http://127.0.0.1:5001/process
Payload: { command: "draw circle" }
Response: JSON data with shape parameters.

## 4. Shape Configuration
Shapes are loaded from JSON files and each have configurations accroding to there unique parameters below is the circle JSON

 ```javascript
{
  "shape": "circle",
  "coordinates": [0, 0, 0],
  "parameters": {
    "radius": 5
  },
  "plane": "XYConstructionPlane"
}

```

Shape: Type of geometric object.
Coordinates: Position in 3D space.
Parameters: Properties like size or radius.
Plane: The construction plane (XY, XZ, or YZ).


## 5. Shape Renderer

The Shape renderer renders 3D shapes on a 2D canvas using mathematical transformations for the user to see their designs before testing in Fusion 360.

